{% extends 'base.html' %}
{% load static %}
{% block title %}Convites de Colaboração{% endblock %}

{% block content %}

<h1 style="margin-bottom: 50px;">
    <a class="icon-brand">
        Convites de Colaboração
    </a>
</h1>
<hr style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid rgba(255, 255, 255, 0.6);">

<!-- Convites Recebidos -->
<h2 style="font-family: 'Georgia'; margin-top: 40px; margin-bottom: 18px; color: white;">
    Convites Recebidos:
</h2>
{% for convite in recebidos %}
  <div class="convite">
    <h3>{{ convite.material.titulo }}</h3>
    <p>{{ convite.material.descricao }}</p>
    <a href="{% url 'visualizar_material' convite.material.id %}">Visualizar Material</a>

    {% if convite.status == 'pendente' %}
      <form method="POST" action="{% url 'responder_convite' convite.id %}">
        {% csrf_token %}
        <button name="resposta" value="aceito">Aceitar</button>
        <button name="resposta" value="negado">Negar</button>
      </form>
    {% elif convite.status == 'aceito' %}
      <p>Convite aceito. Você pode publicar o material:</p>
      <form method="POST" action="{% url 'publicar_material' convite.material.id %}">
        {% csrf_token %}
        <button type="submit">Publicar Material</button>
      </form>
    {% elif convite.status == 'negado' %}
      <p>Você recusou este convite.</p>
    {% endif %}
  </div>
{% empty %}
  <p>Você não tem convites recebidos.</p>
{% endfor %}

<!-- Convites Enviados -->
 <h2 style="font-family: 'Georgia'; margin-top: 40px; margin-bottom: 18px; color: white;">
    Convites Enviados:
</h2>
{% for convite in enviados %}
  <div class="convite">
    <h3>{{ convite.material.titulo }}</h3>
    <p>Status: {{ convite.get_status_display }}</p>

    {% if convite.status == 'negado' %}
      <p>O colaborador {{ convite.destinatario.username }} recusou o convite.</p>
    {% elif convite.status == 'aceito' %}
      <p>Convite aceito. Aguardando publicação pelo colaborador.</p>
    {% else %}
      <p>Convite ainda pendente.</p>
    {% endif %}
  </div>
{% empty %}
  <p>Você não enviou nenhum convite.</p>
{% endfor %}


{% endblock %}